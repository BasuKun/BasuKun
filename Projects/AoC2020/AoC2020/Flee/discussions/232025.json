[
  {
    "Id": "511346",
    "ThreadId": "232025",
    "Html": "\r\n<p>Hello. I've created an application based on Flee and I really like this library, but there is one exception.<br>\r\n<br>\r\nExample source code:<br>\r\n<br>\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>ExpressionContext context = <span style=\"color:blue\">new</span> ExpressionContext();<br>context.Imports.AddType(<span style=\"color:blue\">typeof</span>(Math));<br><br><span style=\"color:green\">//&quot;m&quot; means decimal</span><br>context.Variables[<span style=\"color:#a31515\">&quot;a&quot;</span>] = 10m;<br>context.Variables[<span style=\"color:#a31515\">&quot;b&quot;</span>] = 20m;<br><br>IDynamicExpression eDynamic = context.CompileDynamic(<span style=\"color:#a31515\">&quot;a &amp;&amp; b&quot;</span>);<br><br><span style=\"color:blue\">bool</span> result = (<span style=\"color:blue\">bool</span>)eDynamic.Evaluate();<br></pre>\r\n</div>\r\n<p><br>\r\n<br>\r\nI get an exception <strong>&quot;AndOrElement: Operation 'And' is not defined for types 'Decimal' and 'Decimal'&quot;</strong>.\r\n<br>\r\nHow can I fix it?</p>\r\n<p>&nbsp;</p>\r\n<p><br>\r\nI've tried to modify source code of Flee, but I'm new to Visual Basic. I found a place where the exception is thrown, but I couldn't make it work.<br>\r\nI changed the method GetResultType in AndOr.vb file to:<br>\r\n<br>\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>\t<span style=\"color:blue\">Protected</span> <span style=\"color:blue\">Overrides</span> <span style=\"color:blue\">Function</span> GetResultType(<span style=\"color:blue\">ByVal</span> leftType <span style=\"color:blue\">As</span> System.Type, <span style=\"color:blue\">ByVal</span> rightType <span style=\"color:blue\">As</span> System.Type) <span style=\"color:blue\">As</span> System.Type<br>\t\t<span style=\"color:blue\">Dim</span> bitwiseOpType <span style=\"color:blue\">As</span> Type = Utility.GetBitwiseOpType(leftType, rightType)<br>\t\t<span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> bitwiseOpType <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span><br>\t\t\t<span style=\"color:blue\">Return</span> bitwiseOpType<br>\t\t<span style=\"color:blue\">ElseIf</span> <span style=\"color:blue\">Me</span>.AreBothChildrenOfType(<span style=\"color:blue\">GetType</span>(<span style=\"color:blue\">Boolean</span>)) <span style=\"color:blue\">Then</span><br>\t\t\t<span style=\"color:blue\">Return</span> <span style=\"color:blue\">GetType</span>(<span style=\"color:blue\">Boolean</span>)<br>       \t \t<span style=\"color:blue\">Else</span><br>            \t\t<span style=\"color:blue\">Return</span> <span style=\"color:blue\">GetType</span>(<span style=\"color:blue\">Boolean</span>)<br>\t\t<span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span><br>\t<span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span><br><br></pre>\r\n</div>\r\n<p><br>\r\nbut then I get an exception in Evaluate method in Expression.vb file:<br>\r\n<br>\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre>System.AccessViolationException was unhandled<br>  Message=<span style=\"color:#a31515\">&quot;Attempted to read or write protected memory. This is often an indication that other memory is corrupt.&quot;</span><br>  Source=<span style=\"color:#a31515\">&quot;Ciloci.Flee&quot;</span><br>  StackTrace:<br>       at Flee Expression(<span style=\"color:blue\">Object</span> , ExpressionContext , VariableCollection )<br>       at Ciloci.Flee.Expression`1.Evaluate() <span style=\"color:blue\">in</span> D:\\Dokumenty\\Piotrek\\Ikosoft\\Flee\\src\\<span style=\"color:blue\">Lib</span>\\InternalTypes\\Expression.vb:line 154<br>       at ConsoleTester.Module1.Main() <span style=\"color:blue\">in</span> D:\\Dokumenty\\Piotrek\\Ikosoft\\Flee\\src\\ConsoleTester\\Module1.vb:line 23<br>  InnerException: <br><br></pre>\r\n</div>\r\n<p>&nbsp;</p>\r\n<p>It seems that&nbsp; MyLeftChild and MyRightChild should be converted to Boolean, but how?</p>\r\n<p>Please help. Thank you for any working solutions ASAP.</p>\r\n<p>&nbsp;</p>\r\n<div id=\"x_x__mcePaste\" style=\"left:-10000px; top:0px; width:1px; height:1px; overflow:hidden\">\r\n<p style=\"font-size:67.5px; line-height:86.075px\">Hello. I've created an application based on Flee and really like this library, but there is one exception.</p>\r\n<p style=\"font-size:67.5px; line-height:86.075px\">Example source code:</p>\r\n<p style=\"font-size:67.5px; line-height:86.075px\"><br style=\"font-size:67.5px; line-height:86.075px\">\r\n</p>\r\n<div style=\"color:black; background-color:white\">\r\n<pre style=\"font-size:67.5px; line-height:75.95px\"><div style=\"color:black; background-color:white\"><pre style=\"font-size:67.5px; line-height:75.95px\">ExpressionContext context = <span style=\"color:blue\">new</span> ExpressionContext();<br>context.Imports.AddType(<span style=\"color:blue\">typeof</span>(Math));<br><br><span style=\"color:green\">//&quot;m&quot; means decimal</span><br>context.Variables[<span style=\"color:#a31515\">&quot;a&quot;</span>] = 10m;<br>context.Variables[<span style=\"color:#a31515\">&quot;b&quot;</span>] = 20m;<br><br>IDynamicExpression eDynamic = context.CompileDynamic(<span style=\"color:#a31515\">&quot;a &amp;&amp; b&quot;</span>);<br><br><span style=\"color:blue\">bool</span> result = (<span style=\"color:blue\">bool</span>)eDynamic.Evaluate();<br><br></pre>\r\n</div>\r\n<br><br>I get an exception &quot;AndOrElement: Operation 'And' is not defined for types 'Decimal' and 'Decimal'&quot;. <br style=\"font-size:67.5px; line-height:75.95px\">How can I fix it?<br style=\"font-size:67.5px; line-height:75.95px\">I've tried to modify source code of Flee, but I'm new to Visual Basic. I found a place where the exception is thrown, but I couldn't make it work.<br style=\"font-size:67.5px; line-height:75.95px\">I changed the method GetResultType in AndOr.vb file to:<br style=\"font-size:67.5px; line-height:75.95px\"><br>\r\n<div style=\"color:black; background-color:white\"><br>\r\n<pre style=\"font-size:67.5px; line-height:75.95px\">\t<span style=\"color:blue\">Protected</span> <span style=\"color:blue\">Overrides</span> <span style=\"color:blue\">Function</span> GetResultType(<span style=\"color:blue\">ByVal</span> leftType <span style=\"color:blue\">As</span> System.Type, <span style=\"color:blue\">ByVal</span> rightType <span style=\"color:blue\">As</span> System.Type) <span style=\"color:blue\">As</span> System.Type<br>\t\t<span style=\"color:blue\">Dim</span> bitwiseOpType <span style=\"color:blue\">As</span> Type = Utility.GetBitwiseOpType(leftType, rightType)<br>\t\t<span style=\"color:blue\">If</span> <span style=\"color:blue\">Not</span> bitwiseOpType <span style=\"color:blue\">Is</span> <span style=\"color:blue\">Nothing</span> <span style=\"color:blue\">Then</span><br>\t\t\t<span style=\"color:blue\">Return</span> bitwiseOpType<br>\t\t<span style=\"color:blue\">ElseIf</span> <span style=\"color:blue\">Me</span>.AreBothChildrenOfType(<span style=\"color:blue\">GetType</span>(<span style=\"color:blue\">Boolean</span>)) <span style=\"color:blue\">Then</span><br>\t\t\t<span style=\"color:blue\">Return</span> <span style=\"color:blue\">GetType</span>(<span style=\"color:blue\">Boolean</span>)<br>        <span style=\"color:blue\">Else</span><br>            <span style=\"color:blue\">Return</span> <span style=\"color:blue\">GetType</span>(<span style=\"color:blue\">Boolean</span>)<br>\t\t<span style=\"color:blue\">End</span> <span style=\"color:blue\">If</span><br>\t<span style=\"color:blue\">End</span> <span style=\"color:blue\">Function</span><br></pre>\r\n</div>\r\n<br><br style=\"font-size:67.5px; line-height:75.95px\"><br style=\"font-size:67.5px; line-height:75.95px\"><br style=\"font-size:67.5px; line-height:75.95px\">but then I get an exception in Evaluate method in Expression.vb file:<br style=\"font-size:67.5px; line-height:75.95px\"><br style=\"font-size:67.5px; line-height:75.95px\"></pre>\r\n</div>\r\n<p style=\"font-size:67.5px; line-height:86.075px\"><br style=\"font-size:67.5px; line-height:86.075px\">\r\n</p>\r\n</div>\r\n",
    "PostedDate": "2010-10-22T15:21:04.627-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]